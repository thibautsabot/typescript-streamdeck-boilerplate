!function e(t,n,s){function i(o,a){if(!n[o]){if(!t[o]){var c="function"==typeof require&&require;if(!a&&c)return c(o,!0);if(r)return r(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[o]={exports:{}};t[o][0].call(u.exports,(function(e){return i(t[o][1][e]||e)}),u,u.exports,e,t,n,s)}return n[o].exports}for(var r="function"==typeof require&&require,o=0;o<s.length;o++)i(s[o]);return i}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.StreamDeckPropertyInspectorHandler=n.StreamDeckPluginHandler=n.StreamDeckHandlerBase=n.StreamDeckAction=void 0;const s=e("./stream-deck-action");Object.defineProperty(n,"StreamDeckAction",{enumerable:!0,get:function(){return s.StreamDeckAction}});const i=e("./stream-deck-handler-base");Object.defineProperty(n,"StreamDeckHandlerBase",{enumerable:!0,get:function(){return i.StreamDeckHandlerBase}});const r=e("./stream-deck-plugin-handler");Object.defineProperty(n,"StreamDeckPluginHandler",{enumerable:!0,get:function(){return r.StreamDeckPluginHandler}});const o=e("./stream-deck-property-inspector-handler");Object.defineProperty(n,"StreamDeckPropertyInspectorHandler",{enumerable:!0,get:function(){return o.StreamDeckPropertyInspectorHandler}})},{"./stream-deck-action":2,"./stream-deck-handler-base":3,"./stream-deck-plugin-handler":4,"./stream-deck-property-inspector-handler":5}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.StreamDeckAction=void 0;n.StreamDeckAction=class{constructor(e,t){if(this._sd_events)for(let e of this._sd_events)e(t,this)}}},{}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.StreamDeckHandlerBase=void 0;const s=e("../manager/event.manager"),i=e("../manager/settings.manager");n.StreamDeckHandlerBase=class{constructor(){if(this._documentReady=!1,this._connectionReady=!1,this._globalSettingsReady=!1,this._documentReadyInvoked=!1,this._connectionReadyInvoked=!1,this._globalSettingsInvoked=!1,this._onReadyInvoked=!1,this._debug=!1,this._cachedEvents=[],this._settingsManager=new i.SettingsManager(this),this._eventManager=s.EventManager.INSTANCE,this._sd_events)for(let e of this._sd_events)e("*",this);window.connectElgatoStreamDeckSocket=(e,t,n,s,i)=>{this._port=e,this._uuid=t,this._registerEvent=n,this._info=JSON.parse(s),i&&this._eventManager.callEvents("registerPi","*",i),this._connectElgatoStreamDeckSocket(),this._docReady((()=>{this._documentReady=!0,this._handleReadyState()}))}}get port(){return this._port}get uuid(){return this._uuid}get registerEvent(){return this._registerEvent}get info(){return this._info}get settingsManager(){return this._settingsManager}get documentReady(){return this._documentReady}get connectionReady(){return this._connectionReady}get globalSettingsReady(){return this._globalSettingsReady}setSettings(e,t){this.send("setSettings",{context:t,payload:e})}requestSettings(e){this.send("getSettings",{context:e})}setGlobalSettings(e){this.send("setGlobalSettings",{context:this._uuid,payload:e})}requestGlobalSettings(){this.send("getGlobalSettings",{context:this._uuid})}openUrl(e){this.send("openUrl",{payload:{url:e}})}logMessage(e){this.send("logMessage",{payload:{message:e}})}send(e,t){const n=Object.assign({event:e},t);this._debug&&console.log(`SEND ${e}`,n,this._ws),this._ws?this._ws.send(JSON.stringify(n)):(this._debug&&console.error("COULD NOT SEND. CACHING FOR RESEND EVENT"),this._cachedEvents.push(JSON.stringify(n)))}enableDebug(){this._debug=!0}_docReady(e){"complete"===document.readyState||"interactive"===document.readyState?setTimeout((()=>e()),1):document.addEventListener("DOMContentLoaded",e)}_connectElgatoStreamDeckSocket(){this._ws=new WebSocket("ws://127.0.0.1:"+this._port),this._ws.onopen=()=>this._open(),this._ws.onclose=()=>{this._eventManager.callEvents("connectionClosed")},this._ws.onmessage=e=>this._eventHandler(e)}_open(){if(this.send(this._registerEvent,{uuid:this._uuid}),this._cachedEvents.length>=1){this._debug&&console.log("RESENDING CACHED EVENTS: ",this._cachedEvents);for(let e of this._cachedEvents)this._ws.send(e)}this._connectionReady=!0,this._handleReadyState(),this.requestGlobalSettings()}_handleReadyState(){this._connectionReady&&!this._connectionReadyInvoked&&(this._connectionReadyInvoked=!0,this._eventManager.callEvents("connectionOpened")),this._documentReady&&!this._documentReadyInvoked&&(this._documentReadyInvoked=!0,this._eventManager.callEvents("documentLoaded")),this._globalSettingsReady&&!this._globalSettingsInvoked&&(this._globalSettingsInvoked=!0,this._eventManager.callEvents("globalSettingsAvailable","*",this.settingsManager)),this._globalSettingsInvoked&&this._documentReadyInvoked&&this._connectionReadyInvoked&&!this._onReadyInvoked&&(this._onReadyInvoked=!0,this._eventManager.callEvents("setupReady"))}_eventHandler(e){var t;const n=JSON.parse(e.data),s=n.event;this._debug&&console.log(`RECEIVE ${s}`,n,e),"didReceiveGlobalSettings"===s&&(this.settingsManager.cacheGlobalSettings(n.payload.settings),this._globalSettingsReady=!0,this._handleReadyState()),this._eventManager.callEvents(s,null!==(t=n.action)&&void 0!==t?t:"*",n)}}},{"../manager/event.manager":15,"../manager/settings.manager":16}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.StreamDeckPluginHandler=void 0;const s=e("../classes/stream-deck-action.class"),i=e("../interfaces/enums"),r=e("../manager/action.manager"),o=e("./stream-deck-handler-base");class a extends o.StreamDeckHandlerBase{constructor(){super(),this._actionManager=new r.ActionManager(this)}get actionManager(){return this._actionManager}setTitle(e,t,n=i.TargetType.BOTH,s){s?this.send("setTitle",{context:t,payload:{title:e,target:n,state:s}}):this.send("setTitle",{context:t,payload:{title:e,target:n}})}setImage(e,t,n=i.TargetType.BOTH,s){s?this.send("setImage",{context:t,payload:{image:e,target:n,state:s}}):this.send("setImage",{context:t,payload:{image:e,target:n}})}setImageFromUrl(e,t,n=i.TargetType.BOTH,s){return new Promise(((i,r)=>{let o=new Image;o.onload=()=>{let e=document.createElement("canvas");e.width=o.naturalWidth,e.height=o.naturalHeight;let a=e.getContext("2d");if(!a)return void r(new Error("image failed to load"));a.drawImage(o,0,0),o.onload=null,o.onerror=null,o=null;const c=e.toDataURL("image/png");this.setImage(c,t,n,s),i(c)},o.onerror=()=>{o.onload=null,o.onerror=null,o=null,r(new Error("image failed to load"))},o.src=e}))}showAlert(e){this.send("showAlert",{context:e})}showOk(e){this.send("showOk",{context:e})}setState(e,t){this.send("setState",{context:t,payload:{state:e}})}switchToProfile(e,t){this.send("switchToProfile",{context:this.uuid,device:t||this.info.devices[0].id,payload:{profile:e}})}sendToPropertyInspector(e,t,n){this.send("sendToPropertyInspector",{context:n,action:t,payload:e})}_eventHandler(e){var t,n,i;const r=JSON.parse(e.data);let o,a,c,l,u,d,g,h,v;"didReceiveGlobalSettings"!==r.event&&r.context&&(null===(t=r.payload)||void 0===t?void 0:t.settings)&&this.settingsManager.cacheContextSettings(r.context,r.payload.settings),g=null==r?void 0:r.action,h=null==r?void 0:r.context,v=null==r?void 0:r.device;const _=null==r?void 0:r.payload;o=null==_?void 0:_.settings,u=null==_?void 0:_.state,d=null==_?void 0:_.userDesiredState,c=null==_?void 0:_.isInMultiAction,a=null===(n=null==_?void 0:_.coordinates)||void 0===n?void 0:n.column,l=null===(i=null==_?void 0:_.coordinates)||void 0===i?void 0:i.row;const S=this._actionManager.addOrGetAction(h,new s.StreamDeckActionClass(this));S&&(void 0!==g&&(S.action=g),void 0!==h&&(S.context=h),void 0!==v&&(S.device=v),void 0!==o&&(S.settings=o),void 0!==a&&(S.column=a),void 0!==l&&(S.row=l),void 0!==u&&(S.state=u),void 0!==d&&(S.userDesiredState=d),void 0!==c&&(S.isInMultiAction=c)),super._eventHandler(e)}}n.StreamDeckPluginHandler=a},{"../classes/stream-deck-action.class":6,"../interfaces/enums":12,"../manager/action.manager":14,"./stream-deck-handler-base":3}],5:[function(e,t,n){"use strict";var s=this&&this.__decorate||function(e,t,n,s){var i,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(n,"__esModule",{value:!0}),n.StreamDeckPropertyInspectorHandler=void 0;const i=e("../decorators/on-pi-event.decorator"),r=e("./stream-deck-handler-base");class o extends r.StreamDeckHandlerBase{get actionInfo(){return this._actionInfo}sendToPlugin(e,t){var n;this.send("sendToPlugin",{context:this.uuid,action:t||(null===(n=this._actionInfo)||void 0===n?void 0:n.action),payload:e})}requestSettings(){super.requestSettings(this.uuid)}setSettings(e){super.setSettings(e,this.uuid)}onRegisterPi(e){this._actionInfo=JSON.parse(e),this.requestSettings()}}s([i.SDOnPiEvent("registerPi")],o.prototype,"onRegisterPi",null),n.StreamDeckPropertyInspectorHandler=o},{"../decorators/on-pi-event.decorator":9,"./stream-deck-handler-base":3}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.StreamDeckActionClass=void 0;n.StreamDeckActionClass=class{constructor(e){this._handler=e,this._autoSave=!0,this._autoDebounce=!0,this._isInMultiAction=!1}set settings(e){this._settings=e}get action(){return this._action}set action(e){this._action=e}get context(){return this._context}set context(e){this._context=e}get device(){return this._device}set device(e){this._device=e}get column(){return this._column}set column(e){this._column=e}get row(){return this._row}set row(e){this._row=e}get isInMultiAction(){return this._isInMultiAction}set isInMultiAction(e){this._isInMultiAction=e}get state(){return this._state}set state(e){this._state=e}get userDesiredState(){return this._userDesiredState}set userDesiredState(e){this._userDesiredState=e}disableAutoSave(){this._autoSave=!1}disableAutoDebounce(){this._autoDebounce=!1}enableAutoSave(){this._autoSave=!0}enableAutoDebounce(){this._autoDebounce=!0}getSettings(){return this._settings}getAction(){return this._action}getContext(){return this._context}getDevice(){return this._device}setSettings(e,t=0){this._settings=e,this._autoSave&&this.saveSettings(t)}setSettingsAttributes(e,t=0){const n=this.getSettings();n?this.setSettings(Object.assign(Object.assign({},n),e),t):this.setSettings(Object.assign({},e),t)}saveSettings(e){const t=()=>{this._handler.setSettings(this._settings,this._context)};this._autoDebounce?this.debounceSettingsCall(t,e):t()}debounceSettingsCall(e,t){clearTimeout(this._settingsTimeoutId),this._settingsTimeoutId=setTimeout(e,t)}update(e){const{_action:t,_autoDebounce:n,_autoSave:s,_handler:i,_column:r,_context:o,_device:a,_isInMultiAction:c,_row:l,_settings:u,_state:d,_userDesiredState:g}=e;this._action=null!=t?t:this._action,this._autoDebounce=null!=n?n:this._autoDebounce,this._autoSave=null!=s?s:this._autoSave,this._handler=null!=i?i:this._handler,this._column=null!=r?r:this._column,this._context=null!=o?o:this._context,this._device=null!=a?a:this._device,this._isInMultiAction=null!=c?c:this._isInMultiAction,this._row=null!=l?l:this._row,this._settings=null!=u?u:this._settings,this._state=null!=d?d:this._state,this._userDesiredState=null!=g?g:this._userDesiredState}}},{}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SDOnPiEvent=n.SDOnActionEvent=void 0;const s=e("./on-action-event.decorator");Object.defineProperty(n,"SDOnActionEvent",{enumerable:!0,get:function(){return s.SDOnActionEvent}});const i=e("./on-pi-event.decorator");Object.defineProperty(n,"SDOnPiEvent",{enumerable:!0,get:function(){return i.SDOnPiEvent}})},{"./on-action-event.decorator":8,"./on-pi-event.decorator":9}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SDOnActionEvent=void 0;const s=e("../manager/event.manager");n.SDOnActionEvent=function(e){return(t,n,i)=>s.EventManager.DefaultDecoratorEventListener(e,t,n,i)}},{"../manager/event.manager":15}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SDOnPiEvent=void 0;const s=e("../manager/event.manager");n.SDOnPiEvent=function(e){return(t,n,i)=>s.EventManager.DefaultDecoratorEventListener(e,t,n,i)}},{"../manager/event.manager":15}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.IllegalArgumentError=void 0;class s extends Error{constructor(e){super(e),this.name="IllegalArgumentError"}}n.IllegalArgumentError=s},{}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.StreamDeckActionClass=n.ActionManager=n.SettingsManager=n.EventManager=n.EventType=n.StateType=n.TargetType=n.DeviceType=n.StreamDeckPropertyInspectorHandler=n.StreamDeckPluginHandler=n.StreamDeckHandlerBase=n.StreamDeckAction=n.SDOnPiEvent=n.SDOnActionEvent=void 0;const s=e("./abstracts/abstracts");Object.defineProperty(n,"StreamDeckAction",{enumerable:!0,get:function(){return s.StreamDeckAction}}),Object.defineProperty(n,"StreamDeckHandlerBase",{enumerable:!0,get:function(){return s.StreamDeckHandlerBase}}),Object.defineProperty(n,"StreamDeckPluginHandler",{enumerable:!0,get:function(){return s.StreamDeckPluginHandler}}),Object.defineProperty(n,"StreamDeckPropertyInspectorHandler",{enumerable:!0,get:function(){return s.StreamDeckPropertyInspectorHandler}});const i=e("./classes/stream-deck-action.class");Object.defineProperty(n,"StreamDeckActionClass",{enumerable:!0,get:function(){return i.StreamDeckActionClass}});const r=e("./decorators/decorators");Object.defineProperty(n,"SDOnActionEvent",{enumerable:!0,get:function(){return r.SDOnActionEvent}}),Object.defineProperty(n,"SDOnPiEvent",{enumerable:!0,get:function(){return r.SDOnPiEvent}});const o=e("./interfaces/interfaces");Object.defineProperty(n,"DeviceType",{enumerable:!0,get:function(){return o.DeviceType}}),Object.defineProperty(n,"EventType",{enumerable:!0,get:function(){return o.EventType}}),Object.defineProperty(n,"StateType",{enumerable:!0,get:function(){return o.StateType}}),Object.defineProperty(n,"TargetType",{enumerable:!0,get:function(){return o.TargetType}});const a=e("./manager/action.manager");Object.defineProperty(n,"ActionManager",{enumerable:!0,get:function(){return a.ActionManager}});const c=e("./manager/event.manager");Object.defineProperty(n,"EventManager",{enumerable:!0,get:function(){return c.EventManager}});const l=e("./manager/settings.manager");Object.defineProperty(n,"SettingsManager",{enumerable:!0,get:function(){return l.SettingsManager}})},{"./abstracts/abstracts":1,"./classes/stream-deck-action.class":6,"./decorators/decorators":7,"./interfaces/interfaces":13,"./manager/action.manager":14,"./manager/event.manager":15,"./manager/settings.manager":16}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.EventType=n.StateType=n.TargetType=n.DeviceType=void 0,function(e){e[e.StreamDeck=0]="StreamDeck",e[e.StreamDeckMini=1]="StreamDeckMini",e[e.StreamDeckXL=2]="StreamDeckXL",e[e.StreamDeckMobile=3]="StreamDeckMobile",e[e.CorsairGKeys=4]="CorsairGKeys"}(n.DeviceType||(n.DeviceType={})),function(e){e[e.BOTH=0]="BOTH",e[e.HARDWARE=1]="HARDWARE",e[e.SOFTWARE=2]="SOFTWARE"}(n.TargetType||(n.TargetType={})),function(e){e[e.ON=0]="ON",e[e.OFF=1]="OFF"}(n.StateType||(n.StateType={})),function(e){e[e.ALL=0]="ALL",e[e.PI=1]="PI",e[e.PLUGIN=2]="PLUGIN",e[e.NONE=3]="NONE"}(n.EventType||(n.EventType={}))},{}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.EventType=n.StateType=n.TargetType=n.DeviceType=void 0;const s=e("./enums");Object.defineProperty(n,"DeviceType",{enumerable:!0,get:function(){return s.DeviceType}}),Object.defineProperty(n,"EventType",{enumerable:!0,get:function(){return s.EventType}}),Object.defineProperty(n,"StateType",{enumerable:!0,get:function(){return s.StateType}}),Object.defineProperty(n,"TargetType",{enumerable:!0,get:function(){return s.TargetType}})},{"./enums":12}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ActionManager=void 0;n.ActionManager=class{constructor(e){this._handler=e,this._actions=new Map}getAction(e){return this._actions.get(e)}addOrGetAction(e,t){return this.getAction(e)||this._actions.set(e,t),this.getAction(e)}}},{}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.EventManager=void 0;const s=e("../errors/illegal-argument.error");class i{constructor(){this.registeredEvents=new Map}static get INSTANCE(){return this._INSTANCE||(this._INSTANCE=new i),this._INSTANCE}static DefaultDecoratorEventListener(e,t,n,r){return t._sd_events||(t._sd_events=[]),t._sd_events.push(((t,n)=>{if("string"!=typeof t)throw new s.IllegalArgumentError(`actionName needs to be of type string but ${typeof t} given.`);i.INSTANCE.registerEvent(e,((e,...s)=>{e&&"*"!==t&&t!==e||r.value.apply(n,s)}))})),r}registerEvent(e,t){var n;this.registeredEvents.has(e)||this.registeredEvents.set(e,[]),null===(n=this.registeredEvents.get(e))||void 0===n||n.push(t)}callEvents(e,t="*",...n){var s;null===(s=this.registeredEvents.get(e))||void 0===s||s.forEach((e=>e(t,...n)))}}n.EventManager=i},{"../errors/illegal-argument.error":10}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SettingsManager=void 0;n.SettingsManager=class{constructor(e){this._handler=e,this._settings=new Map,this._globalSettings={},this._autoSave=!0,this._autoDebounce=!0,this.contextSettingsTimeoutIds={}}disableAutoSave(){this._autoSave=!1}disableAutoDebounce(){this._autoDebounce=!1}getGlobalSettings(){return this._globalSettings}setGlobalSettings(e,t=0){this._globalSettings=e,this._autoSave&&this.saveGlobalSettings(t)}setGlobalSettingsAttributes(e,t=0){this.setGlobalSettings(Object.assign(Object.assign({},this.getGlobalSettings()),e))}getContextSettings(e){return this._settings.get(e)}getAllContextSettings(){return this._settings}setContextSettings(e,t,n=0){this._settings.set(e,t),this._autoSave&&this.saveContextSettings(e,n)}setContextSettingsAttributes(e,t,n=0){const s=this.getContextSettings(e);s?this.setContextSettings(e,Object.assign(Object.assign({},s),t),n):this.setContextSettings(e,Object.assign({},t),n)}saveGlobalSettings(e){const t=()=>{this._handler.setGlobalSettings(this._globalSettings)};this._autoDebounce?this.debounceGlobalSettingsCall(t,e):t()}saveContextSettings(e,t){const n=()=>{if("ALL"===e)for(let[e,t]of this._settings)this._handler.setSettings(t,e);else this._settings.get(e)&&this._handler.setSettings(this._settings.get(e),e)};this._autoDebounce?this.debounceContextSettingsCall(e,n,t):n()}cacheGlobalSettings(e){this._globalSettings=e}cacheContextSettings(e,t){this._settings.set(e,t)}debounceGlobalSettingsCall(e,t){clearTimeout(this.globalSettingsTimeoutId),this.globalSettingsTimeoutId=setTimeout(e,t)}debounceContextSettingsCall(e,t,n){clearTimeout(this.contextSettingsTimeoutIds[e]),this.contextSettingsTimeoutIds[e]=setTimeout(t,n)}}},{}],17:[function(e,t,n){"use strict";var s=this&&this.__decorate||function(e,t,n,s){var i,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(n,"__esModule",{value:!0});const i=e("streamdeck-typescript");class r extends i.StreamDeckPropertyInspectorHandler{constructor(){super()}onDocumentReady(){var e,t;this.count=document.getElementById("count"),this.count.addEventListener("keyup",(()=>this.settingsManager.setContextSettingsAttributes(this.actionInfo.context,{count:this.count.valueAsNumber},500))),this.stepsCount=document.getElementById("steps"),this.stepsCount.addEventListener("keyup",(()=>this.settingsManager.setContextSettingsAttributes(this.actionInfo.context,{steps:this.stepsCount.valueAsNumber},500)));const n=this.settingsManager.getContextSettings(this.actionInfo.context);this.count.value=(null!==(e=null==n?void 0:n.count)&&void 0!==e?e:0).toString(),this.stepsCount.value=(null!==(t=null==n?void 0:n.steps)&&void 0!==t?t:1).toString()}onSettingsReceived({payload:{settings:e}}){var t,n;Object.keys(e).length<=0||(this.count.value=null!==(t=e.count.toString())&&void 0!==t?t:0,this.stepsCount.value=null!==(n=e.steps.toString())&&void 0!==n?n:1)}}s([i.SDOnPiEvent("documentLoaded")],r.prototype,"onDocumentReady",null),s([i.SDOnPiEvent("didReceiveSettings")],r.prototype,"onSettingsReceived",null),new r},{"streamdeck-typescript":11}]},{},[17]);